# Neural Frequent Subgraph Mining

This package contains an implementation of SPMiner, a graph neural network based framework to extract frequent subgraph patterns from an input graph dataset.

Running the pipeline consists of training the encoder on synthetic data, then running the decoder on the dataset from which to mine patterns.

## Train the encoder
1. Train the encoder: `python3 -m encoder.train --node_anchored`
2. Optionally, analyze the trained encoder via `python3 -m encoder.test --node_anchored`, or by running the "Analyze Embeddings" notebook in `analyze/`

Full configuration options can be found in `encoder/config.py`.

## Run the decoder
1. `python3 -m decoder.decoder --dataset=enzymes --node_anchored`

Full configuration options can be found in `decoder/config.py`.

## Analyze results
- Analyze the order embeddings after training the encoder: `python3 -m analyze.analyze_embeddings --node_anchored`
- Count the frequencies of patterns generated by the decoder: `python3 -m analyze.count_patterns --dataset=enzymes --out_path=results/counts.json --node_anchored`
- Analyze the raw output from counting: `python3 -m analyze.analyze_pattern_counts --counts_path=results/`
